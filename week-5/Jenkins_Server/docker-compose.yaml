version: "3.8"
services:
  jenkins:
    hostname: jenkins
    build:
      context: .
      dockerfile: Dockerfile
      args:
        JENKINS_IMAGE: "${JENKINS_IMAGE:-docker.io/jenkins/jenkins}"
        JENKINS_TAG: "${JENKINS_TAG:-lts}"        
        HOST_DOCKER_GID: "${HOST_DOCKER_GID}" 
    ports:
      - "${JENKINS_PORT:-8080}:8080"
    volumes:
      - "/var/run/docker.sock:/var/run/docker.sock"
      - "newfolder_jenkins_home:/var/jenkins_home"
    networks:
      - my_custom_network
  
  artifactory:
    image: releases-docker.jfrog.io/jfrog/artifactory-oss:7.63.14
    environment:
      - JF_ROUTER_ENTRYPOINTS_EXTERNALPORT=${ARTIFACTORY_PORT_UI:-8082}
    ports:
      - ${ARTIFACTORY_PORT_UI:-8082}:${ARTIFACTORY_PORT_UI:-8082}
      - ${ARTIFACTORY_PORT:-8081}:8081
    volumes:
      - "artifactory_data:/var/opt/jfrog/artifactory"
    networks:
      - my_custom_network

networks:
  my_custom_network:
    driver: bridge

volumes:
  newfolder_jenkins_home:
    external:
      name: newfolder_jenkins_home
  artifactory_data:
    external: 
      name: artifactory_data

